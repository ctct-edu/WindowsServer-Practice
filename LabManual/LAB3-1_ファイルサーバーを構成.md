---
lab:
    title: 'ファイルサーバーの高度な管理'
---

# ラボ3-1 - ファイルサーバーを構成（目安：20分）

## 演習で使用するマシン

以下のマシンを使用します。

| マシン名           | 用途/目的            |
| ------------------ | -------------------- |
| DomainController_1 | ドメイン環境         |
| FileServer_1       | ファイルサーバー構成 |
| FileServer_2       | ファイルサーバー構成 |



## 目標

このラボでは次の内容を学習します。

- タスク 1：各ファイルサーバーをドメイン参加させる

- タスク 2：ファイルサーバーを構成する

- タスク 3：共有フォルダーを構成する

- タスク 4：共有フォルダーにクォータの設定をする

- タスク 5：クォータの設定を確認する

  

## 手順

#### タスク 1：各ファイルサーバーをドメイン参加させる

FileServer_1、FileServer_2で、それぞれ実施します。

1. スタートメニューからPowerShellを起動し、以下のコマンドを入力します。

   ```powershell
   Add-Computer -DomainName "ctct.local" -Credential (New-Object System.Management.Automation.PSCredential("ctct\administrator", (ConvertTo-SecureString "Pa55w.rd1234" -AsPlainText -Force))) -Restart
   ```

2. 実行後、自動で再起動されます。再びサインインしてください。



#### タスク 2：ファイルサーバーを構成する

この手順はFileServer_1で実施してください。

1. 「スタート」メニューを開き、「サーバーマネージャー」を選択して起動します。

2. サーバーマネージャーダッシュボードにて、「役割と機能の追加」をクリックします。

3. 「役割と機能の追加ウィザード」ウィンドウが開きます。画面の指示に従って「次 >」をクリックします。

4. 「インストールの種類の選択」画面で「役割ベースまたは機能ベースのインストール」を選択し、「次 >」をクリックします。

5. 「サーバーの選択」画面で、「次 >」をクリックします。

6. 「役割の選択」画面にて、「ファイルサービスと記憶域サービス」を展開します。

7. さらに「ファイルサービスおよびiSCSIサービス」を展開します。

8. 以下の役割にチェックを入れ、「次 >」をクリックします。

   ・ファイルサーバー

   ・DFSレプリケーション

   ・DFS名前空間

   ・ファイルサーバーリソースマネージャー

9. 「機能の選択」画面では、追加で必要な機能を選択して「次 >」をクリックします。

10. 「確認」画面で設定を確認し、「インストール」をクリックします。

11. インストールが完了したら、「閉じる」をクリックしてウィザードを終了します。



#### タスク 3：共有フォルダーを構成する

この手順はFileServer_1で実施してください。

1. 「スタート」メニューを開き、「サーバーマネージャー」を選択して起動します。
2. サーバーマネージャーの左側のナビゲーションペインから「ファイルサービスと記憶域サービス」をクリックし、更に「共有」を選択します。
3. 右側にあるから「ファイル共有を作成するには、新しい共有ウィザードを実行していください。」リンクをクリックします。
4. 「新しい共有ウィザード」が開きます。
5. 「共有の種類の選択」画面で「SMB の共有 -簡易」を選択し、「次 >」をクリックします。
6. 「共有の場所」画面で、デフォルトのまま「次 >」をクリックします。
7. 「共有名」画面で、共有名に「共有フォルダー」と入力し、「次 >」をクリックします。
8. 「他の設定」画面で、デフォルトのまま「次 >」をクリックします。
9. 「アクセス許可の設定」画面で、デフォルトのまま「次 >」をクリックします。
10. 「確認」画面で設定を確認し、問題なければ「作成」をクリックします。
11. 共有の作成が完了したら、「閉じる」をクリックしてウィザードを終了します。
12. サーバーマネージャーの「ファイルサービスと記憶域サービス」>「共有」のセクションを確認し、「共有フォルダー」という名前の共有がリストにあることを確認します。



#### タスク 4：共有フォルダーにクォータの設定をする

この手順はFileServer_1で実施してください。

1. サーバーマネージャーを起動し、左側のナビゲーションペインから 「ツール」 > 「ファイル サーバー リソース マネージャー」 を選択します。
2. ファイルサーバーリソースマネージャーが起動したら、左側のナビゲーションペインから 「クォータの管理」 をクリックします。
3. 画面中央にあるクォータ」をダブルクリックします。
4. 右側の「操作」メニューから 「クォータの作成」 を選択します。
5. 「クォータの作成」ウィザードが開きます。「クォータパス」に`C:\Shares\共有フォルダ`を入力し、作成をクリックします。
6. 作成が完了したら、「閉じる」 をクリックしてウィザードを終了します。



#### タスク 5：クォータの設定を確認する

この手順はFileServer_1で実施してください。

1. スタートメニューからPowerShellを起動し、以下のコマンドを入力し、50MBのファイルを作成します。

   ```cmd
   fsutil file createnew C:\Shares\共有フォルダー\testfile.dat 52428800
   ```

2. さらに以下のコマンドを入力し、100MBのファイルを作成します。

   ```cmd
    fsutil file createnew C:\Shares\共有フォルダー\testfile2.dat 104857600
   ```

3. 「エラー:  ディスクに十分な空き領域がありません。」と表示されれば、成功です。



これでラボは完了です。お疲れ様でした。
